% Δεδομένα
data = [41 46 47 47 48 50 50 50 50 50 50 50 48 50 50 50 50 50 50 50 52 52 53 55 50 50 50 50 52 52 53 53 53 53 53 57 52 52 53 53 53 53 53 53 54 54 55 68];
n = length(data);         % Μέγεθος δείγματος
alpha = 0.05;             % Επίπεδο σημαντικότητας για 95% ΔΕ

% Υπολογισμός της δειγματικής διασποράς,τυπικής απόκλισης και της δειγματικής μέσης τιμής
sample_variance = var(data);
sample_mean = mean(data);    % Δειγματική μέση τιμή
sample_std = std(data);      % Δειγματική τυπική απόκλιση

%% (α) Υπολογισμός του Διαστήματος Εμπιστοσύνης χωρίς την vartest 
% Οριακά σημεία της κατανομής chi-square
chi2_low = chi2inv(alpha/2, n-1);
chi2_high = chi2inv(1 - alpha/2, n-1);

% Διάστημα εμπιστοσύνης για τη διασπορά
CI_low = (n-1) * sample_variance / chi2_high;
CI_high = (n-1) * sample_variance / chi2_low;

% Εμφάνιση αποτελεσμάτων
fprintf('(α) Διάστημα εμπιστοσύνης για τη διασπορά: [%.4f, %.4f] \n', CI_low, CI_high);


%% (β) Έλεγχος υπόθεσης για την τυπική απόκλιση με vartest
sample_variance_0 = 5^2;  % Διασπορά υπό την H0 (τυπική απόκλιση 5kV)

% Χρήση της συνάρτησης vartest για τον έλεγχο της διασποράς
[h_var, p_var, ci_var, stats_var] = vartest(data, sample_variance_0, 'Alpha', alpha);

fprintf('(β) P-value για τον έλεγχο υπόθεσης (διασπορά = 25): %.4f \n', p_var);
if h_var == 1
    fprintf('Απορρίπτουμε την H0: Η διασπορά δεν είναι 25kV^2.\n');
else
    fprintf('Δεν μπορούμε να απορρίψουμε την H0: Η διασπορά μπορεί να είναι 25kV^2.\n');
end

%% (γ) Διάστημα εμπιστοσύνης για τη μέση τάση διακοπής

% Τιμή t για το 95% διάστημα εμπιστοσύνης
t_value = tinv(1 - alpha/2, n - 1);

% Διάστημα εμπιστοσύνης για τη μέση τιμή
CI_mean_low = sample_mean - t_value * sample_std / sqrt(n);
CI_mean_high = sample_mean + t_value * sample_std / sqrt(n);

fprintf('(γ) Διάστημα εμπιστοσύνης για τη μέση τιμή: [%.4f, %.4f] \n', CI_mean_low, CI_mean_high);

%% (δ) Έλεγχος υπόθεσης για τη μέση τάση διακοπής (H0: μ = 52 kV)
mean_0 = 52; % Η υποτιθέμενη μέση τιμή

% Στατιστική του ελέγχου t
[t_statistic, p_value_mean, ~, stats] = ttest(data, mean_0);

fprintf('(δ) P-value για τον έλεγχο υπόθεσης H0: μ = 52kV: %.4f \n', p_value_mean);

if p_value_mean < alpha
    fprintf('Απορρίπτουμε την H0: Η μέση τάση διακοπής δεν είναι 52kV. \n');
else
    fprintf('Δεν μπορούμε να απορρίψουμε την H0: Η μέση τάση διακοπής θα μπορούσε να είναι 52kV. \n');
end

%% (ε) Έλεγχος X^2 καλής προσαρμογής σε κανονική κατανομή

% Υπολογισμός του χ^2 ελέγχου καλής προσαρμογής
[h_chi2, p_value_chi2] = chi2gof(data);

fprintf('(ε) P-value για τον έλεγχο χ^2 καλής προσαρμογής: %.4f \n', p_value_chi2);

if h_chi2 == 0
    fprintf('Δεν απορρίπτουμε την κανονική κατανομή: Τα δεδομένα μπορεί να ακολουθούν κανονική κατανομή. \n');
else
    fprintf('Απορρίπτουμε την κανονική κατανομή: Τα δεδομένα δεν ακολουθούν κανονική κατανομή. \n');
end
